{
  "title": "High CPU Incident Response",
  "id": "incident-response-cpu",
  "service": "Application",
  "category": "Incident",
  "tags": ["incident", "cpu", "critical"],
  "shortDescription": "Steps to mitigate high CPU usage alerts.",
  "fullDescription": "Standard Operating Procedure for diagnosing and resolving high CPU utilization alerts on application servers.",
  "type": "qrun",
  "steps": [
    {
      "title": "Acknowledge Alert",
      "content": [
        { "type": "text", "text": "Acknowledge the alert in PagerDuty/OpsGenie to indicate investigation is underway." }
      ]
    },
    {
      "title": "Identify Affected Server",
      "content": [
        { "type": "text", "text": "Check the monitoring dashboard to identify which specific instance is reporting high CPU." },
        { "type": "code", "language": "text", "code": "Dashboard URL: https://monitor.example.com/cpu-overview" }
      ]
    },
    {
      "title": "SSH into Server",
      "content": [
        { "type": "text", "text": "Connect to the affected instance." },
        { "type": "code", "language": "bash", "code": "ssh support@app-server-01" }
      ]
    },
    {
      "title": "Identify Top Consumers",
      "content": [
        { "type": "text", "text": "Run 'top' or 'htop' to see which process is consuming CPU." },
        { "type": "code", "language": "bash", "code": "top -o %CPU" }
      ]
    },
    {
      "title": "Check Application Logs",
      "content": [
        { "type": "text", "text": "Tail the application logs to check for error loops or heavy request spikes." },
        { "type": "code", "language": "bash", "code": "tail -f /var/log/app/error.log" }
      ]
    },
    {
      "title": "Check System Load",
      "content": [
        { "type": "text", "text": "Verify if the load is due to I/O wait or pure CPU processing." },
        { "type": "code", "language": "bash", "code": "vmstat 1 5" }
      ]
    },
    {
      "title": "Capture Thread Dump (If Java/Node)",
      "content": [
        { "type": "text", "text": "If the process is a Java or Node app, capture a thread dump for later analysis." },
        { "type": "code", "language": "bash", "code": "jstack <PID> > /tmp/thread_dump.txt" }
      ]
    },
    {
      "title": "Restart Service",
      "content": [
        { "type": "text", "text": "If the process is stuck or unresponsive, attempt a graceful restart." },
        { "type": "code", "language": "bash", "code": "sudo systemctl restart my-app-service" }
      ]
    },
    {
      "title": "Verify Recovery",
      "content": [
        { "type": "text", "text": "Wait 2 minutes and check if CPU usage normalizes." },
        { "type": "code", "language": "bash", "code": "top -p <NEW_PID>" }
      ]
    },
    {
      "title": "Scale Out (Optional)",
      "content": [
        { "type": "text", "text": "If looking at overall high load and not a bug, consider adding more instances to the pool." }
      ]
    },
    {
      "title": "Resolution Notes",
      "content": [
        { "type": "text", "text": "Update the ticket with findings and attach any captured logs or dumps." }
      ]
    }
  ]
}
